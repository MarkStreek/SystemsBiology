---
title: "Glucocorticoid receptor dynamica"
author: "L T Stein & M van de Streek"
date: "`r Sys.Date()`"

header-includes:
   - \usepackage{longtable}
   - \usepackage{hyperref}
output:
    pdf_document:
      number_sections: yes
linkcolor: blue
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introductie

Tijdens dit onderzoek wordt er gekeken naar glucocorticosteroiden. En in het speciaal naar de dynamica hiervan. Glucocorticosteroiden zijn hormonen die worden geproduceerd in de bijnierschors. Het is een samenstelling van glucose, cortex en stereoïde. Glucocorticosteroiden worden ook vaak gebruikt in de remming van ontstekingen. Voor bepaalde ziekten zijn ze zeer geschikt, maar voor een aantal ziekten hebben ze geen effect.

De glucocorticosteroiden binden aan receptoren, er ontstaat dan een glucocorticoïdereceptorcomplex (GR). Dit complex verplaatst naar de celkern en bindt hier aan het DNA. De transcriptie van genen die ontstekingen veroorzaken worden tegengehouden door de complexen. Tegelijkertijd worden de genen die ontsteking remmen juist gepromoveerd. Er komen dus meer eiwitten die de ontsteking onderdrukken.

De receptor is een belangrijke speler in het model. Want bij een toenemende hoeveelheid drug zal er een hogere hoeveelheid complex ontstaan, wat weer resulteert in een hogere onderdrukking van de ontsteking.

Omdat de werking zeer specifiek is, werkt het uitstekend bij een ziekte als astma. Echter zijn er ook ziekten waar het helemaal geen invloed heeft. Helaas hangen er ook nadelen aan het gebruik van deze drug. Er ontstaan veel bijwerkingen. Zo kan er bijvoorbeeld diabetes ontstaan, een toename van de witte bloedcellen of er kan een bacteriële infectie ontstaan. 

Het is dus noodzakelijk dat de juiste hoeveeelheid glucocorticosteroiden wordt gebruikt, want bij een te hoog aantal kunnen de bijwerkingen de overhand nemen. 

Glucocorticosteroiden zit in veel medicijnen. In dit onderzoek gaan we kijken naar methylprednisolon, dit is een specifieke vorm van een glucocorticosteroïde. We gaan kijken naar een model die het gebruik van methylprednisolon weergeeft. We kunnen aan de hand van dit model bijvoorbeeld bekijken wat er gebeurt met het aantal mRNA, als het gebruik van de stereoïden toeneemt.

## Doel
  
Het doel van dit onderzoek is om een juiste hoeveelheid glucocorticosteroiden te ontdekken, als toepassing van medicijn. Dit betekent dus ook een lage hoeveelheid bijwerkingen. Dit doel willen we bereiken door te kijken naar de vergelijkingen van het model. Door te kijken naar verschillende tijdschema's, kunnen de verlopen van verschillende factoren weergegeven worden. Aan de hand van deze visualitaties kan het beste aantal bepaalt worden.

De verwachting zal zijn dat het aantal glucocorticosteroïden niet te hoog zal zijn, want dit zal direct resulteren in veel bijwerkingen. Het aantal zal dus eerder rond het midden liggen, d.w.z een middenweg tussen geen effect en veel bijwerkingen.

## Theorie

- Describe biological model
- Picture of the biological model

```{r, echo=FALSE, out.width='95%'}
#knitr::include_graphics('example.png')
```
Give an explanation of the model with citations of source \cite{Soertaert10} (replace this with actual source)
and formula explanation

$$\frac{\delta R}{\delta t} = -r * R + m $$
Describe each element and the transformations

# Methode

## Het software model

Om de juiste verlopen van factoren weer te geven, moeten de differentiaal vergelijkingen worden uitgevoerd met verschillende waardes. Dit zal gedaan worden met het deSolve pakket \cite{deSolve} (versie 1.35) in R (versie 4.2.2). 

Onderstaand zal de code voor alle vier de vergelijkingen weergegeven worden. Tussen de code door zal commentaar gegeven worden.

```{r}
# Inladen van het deSolve pakket
library(deSolve)
```

```{r}
# Defineren van de parameters
parameters <- c(Ks_Rm = 2.90, IC50_Rm = 26.2, 
                Kon = 0.00329, KT = 0.63, 
                Kre = 0.57, RF = 0.49, 
                Kd_R = 0.0572, Kd_Rm = 0.612, 
                Ksr = 3.22, D = 53)

# Tijdspunten defineren
times <- 0 : 48

# Het defineren van de initiële waardes
initial.values <- c(DR_N = 0, mRNAr = 4.74, R = 267, DR = 0)
```

```{r}
verandering_dt <- function (time, parameters, initial.values) {
  with(as.list(c(parameters, initial.values)),{
    
    # Vergelijking van mRNAr
    mRNAr.dt <- Ks_Rm * (1 - (DR_N / IC50_Rm + DR_N)) - Kd_Rm * mRNAr
    # Vergelijking van R
    R.dt <- Ksr * mRNAr + RF * Kre * DR_N - Kon * D * R - Kd_R * R
    # Vergelijking van DR
    DR.dt <- Kon * D * R - KT * DR
    # Vergelijking van DR(N)
    DR_N.dt <- KT * DR - Kre * DR_N
    
    # Retourneren van de initiële waardes
    return(list(c(DR_N.dt, mRNAr.dt, R.dt, DR.dt)))
    
  })
}

# Het aanroepen van de ode functie met de juiste waardes
verloop.dataset <- ode(initial.values, times, verandering_dt, parameters)

plot(verloop.dataset, 
     lwd = 2.5,
     xlab = "Tijd (in uren)",
     ylab = "Aantal stof (in ...)",
     col = "darkblue")
```

## Model configuratie

Explain chosen initial state, parameter values and time sequence. Use tables with values as for example below

```{=tex}
\begin{longtable}[l]{l|l|l}
\caption{Parameter Values} \\ \hline
\label{param_table}
$\textbf{Parameter}$             &$\textbf{Value}$& $\textbf{Unit}$              \\ \hline
\endhead
$a$       & 0.08  & $hour^{-1}$         \\ \hline
$b$       & 0.06  & $hour^{-1}$         \\ \hline
$c$       & 0.06  & $hour^{-1}$         \\ \hline
\end{longtable}
```

# Results

Introduction of results, how does it answer your research questions.

De verloop van alle initiële waardes is in bovenstaand onderdeel uitgebreid berekent. De resultaten zijn opgeslagen in een variabele. We kunnen deze resultaten onderstaand weergeven in de vorm van een grafiek. Er zijn vier waardes, en er komen dus ook vier grafieken.

```{r, fig.cap="Nog in te vullen..."}
plot(verloop.dataset, 
     lwd = 2.5,
     xlab = "Tijd (in uren)",
     ylab = "Aantal stof (in ...)",
     col = "darkblue")
```

- Describe what can be seen in such way that it leads to an answer to your research questions
- Give your figures a number and a descriptive title.
- Provide correct axis labels (unit and quantity), legend and caption.
- Always refer to and discuss your figures and tables in the text - they never stand alone.


# Discussion and Conclusion
## Discussion
- Compare your results with what is expecting from the literature and discuss differences with them.
- Discuss striking and surprising results.
- Discuss weaknesses in your research and how they could be addressed.

## General conclusion and perspective
Discuss what your goal was, what the end result is and how you could continue working from here.

```{=tex}
\begin{thebibliography}{9}

\bibitem{deSolve}
Soetaert, K., Petzoldt, T., and Woodrow Setzer, R.: \textit{Solving differential equations in R: package deSolve}, J. Stat. Softw., 33, 1-25, 2010.

\end{thebibliography}
```